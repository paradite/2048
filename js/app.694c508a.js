(function(e){function t(t){for(var n,a,c=t[0],u=t[1],l=t[2],h=0,f=[];h<c.length;h++)a=c[h],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);s&&s(t);while(f.length)f.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,c=1;c<r.length;c++){var u=r[c];0!==o[u]&&(n=!1)}n&&(i.splice(t--,1),e=a(a.s=r[0]))}return e}var n={},o={app:0},i=[];function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/2048/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var s=u;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"2b94":function(e,t,r){"use strict";r("f046")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23"),o={id:"app"},i=Object(n["f"])("div",{class:"header"},[Object(n["e"])(" 2048 game with an auto solver"),Object(n["f"])("br"),Object(n["e"])(" by "),Object(n["f"])("a",{href:"https://github.com/paradite/2048"},"@paradite")],-1),a={class:"info-row"},c={class:"info-box"},u=Object(n["f"])("div",{class:"info-title"},"Move count",-1),l={class:"info-content"},s={class:"info-box"},h=Object(n["f"])("div",{class:"info-title"},"Score",-1),f={class:"info-content"},v={class:"buttons"},d={class:"scores"},b=Object(n["e"])(" High Scores "),g=Object(n["f"])("br",null,null,-1),m={key:0};function w(e,t,r,w,p,j){var O=Object(n["j"])("GameBoard");return Object(n["h"])(),Object(n["c"])("div",o,[i,Object(n["f"])("div",a,[Object(n["f"])("div",c,[u,Object(n["f"])("div",l,Object(n["k"])(p.game.moveCount),1)]),Object(n["f"])("div",s,[h,Object(n["f"])("div",f,Object(n["k"])(p.game.score),1)])]),Object(n["f"])(O,{game:p.game,cells:p.cells,animation:p.animation},null,8,["game","cells","animation"]),Object(n["f"])("div",v,[Object(n["f"])("div",{class:"button button-primary",onClick:t[1]||(t[1]=function(){return j.handleSolve&&j.handleSolve.apply(j,arguments)})}," Once "),Object(n["f"])("div",{class:["button button-primary",{active:p.game.isAuto}],onClick:t[2]||(t[2]=function(){return j.handleAuto&&j.handleAuto.apply(j,arguments)})}," Magic ",2),Object(n["f"])("div",{class:"button button-primary",onClick:t[3]||(t[3]=function(){return j.restart&&j.restart.apply(j,arguments)})}," Restart ")]),Object(n["f"])("div",d,[b,g,0===p.game.highScores.length?(Object(n["h"])(),Object(n["c"])("span",m," (empty)")):Object(n["d"])("",!0),(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["i"])(p.game.highScores,(function(e,t){return Object(n["h"])(),Object(n["c"])("div",{key:t,class:"score"}," [score: "+Object(n["k"])(e[0])+", moves: "+Object(n["k"])(e[1])+", max: "+Object(n["k"])(e[2])+"] ",1)})),128))])])}var p=r("ade3"),j={class:"bg"},O=Object(n["f"])("div",null,null,-1);function y(e,t,r,o,i,a){return Object(n["h"])(),Object(n["c"])("div",{class:"board",style:{width:a.totalSize+"px",height:a.totalSize+"px",padding:i.marginSize+"px"}},[(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["i"])(r.cells,(function(e){var t;return Object(n["h"])(),Object(n["c"])("div",{key:e.id,class:["cell",(t={},Object(p["a"])(t,"cell-".concat(e.number),!0),Object(p["a"])(t,"fade-in",r.animation&&e&&e.count===r.game.moveCount),t)],id:e.id,style:{left:i.cellSize*e.col+i.marginSize*(e.col+1)+"px",top:i.cellSize*e.row+i.marginSize*(e.row+1)+"px",transition:r.animation?"all 0.1s":""}},Object(n["k"])(e.number),15,["id"])})),128)),Object(n["f"])("div",j,[(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["i"])(r.game.rows,(function(e,t){return Object(n["h"])(),Object(n["c"])("div",{key:t,class:"row",style:{width:a.totalSize+"px",height:i.cellSize+"px",marginBottom:t===r.game.rows.length-1?0:i.marginSize+"px"}},[(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["i"])(e,(function(t,r){return Object(n["h"])(),Object(n["c"])("div",{key:r,class:"cell-bg",style:{width:i.cellSize+"px",height:i.cellSize+"px",marginRight:r===e.length-1?0:i.marginSize+"px"}},null,4)})),128))],4)})),128))]),O],4)}r("99af");var A=r("3835"),k=r("d4ec"),S=r("bee2"),C=r("cd3f"),x=r.n(C),z=(r("b64b"),{ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown"}),E=[z.ArrowLeft,z.ArrowRight,z.ArrowUp,z.ArrowDown],M=function(e,t){if(t)for(var r=0;r<e.length;r++){for(var n="",o=e[r],i=0;i<o.length;i++)o[i]&&o[i].number>=10?n+=o[i].number+" ":o[i]?n+=o[i].number+"  ":n+=".  ";console.log(n)}};function R(e){if(0==e.length)return null;for(var t={},r=e[0],n=1,o=0;o<e.length;o++){var i=e[o];null==t[i]?t[i]=1:t[i]++,t[i]>n&&(r=i,n=t[i])}return r}var N=r("ec26"),P=function(){function e(t,r,n,o){Object(k["a"])(this,e),this.row=t,this.col=r,this.number=n,this.count=o,this.id=Object(N["a"])()}return Object(S["a"])(e,[{key:"is",value:function(e){return this.number===e}},{key:"add",value:function(e){this.number=this.number+e}},{key:"updatePos",value:function(e,t){this.row=e,this.col=t}}]),e}(),D=2048,L=!1,F=[[[void 0,2,32,4],[void 0,void 0,void 0,32],[void 0,void 0,2,4],[void 0,void 0,2,void 0]],[[void 0,void 0,void 0,void 0],[void 0,void 0,4,4],[void 0,2,8,8],[2,128,256,4]],[[8,64,4,void 0],[8,256,8,2],[4,32,512,128],[2,4,16,2]]],I=function(){function e(){Object(k["a"])(this,e),this.rows=[],this.cells=[],this.moved={},this.moveCount=0,this.score=0,this.highScores=[],this.isAuto=!1,this.autoInterval=null}return Object(S["a"])(e,[{key:"resetRows",value:function(){this.rows=new Array(e.rowCount);for(var t=0;t<this.rows.length;t++)this.rows[t]=new Array(e.colCount);e.addRandomNumbers(2,this.rows,this.moveCount),this.updateCells()}},{key:"setupTest",value:function(t){var r=this;this.rows=new Array(e.rowCount);for(var n=0;n<this.rows.length;n++)this.rows[n]=new Array(e.colCount);e.runForEachCell((function(n,o){F[t][n][o]&&e.addNumberToPosition(F[t][n][o],n,o,r.moveCount,r.rows)}),this.rows),this.updateCells()}},{key:"restart",value:function(){this.moveCount=0,this.score=0,this.resetRows()}},{key:"updateCells",value:function(){var t=[];e.runForEachCell((function(e,r,n){n&&t.push(n)}),this.rows),t.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0})),this.cells=t}},{key:"checkWin",value:function(){var t=this,r=!1;if(e.runForEachCell((function(n,o,i){i&&i.number===e.winNumber&&(t.highScores.push([t.score,t.moveCount,e.winNumber]),r=!0)}),this.rows),r)return this.restart(),!0}},{key:"checkLose",value:function(){var t=this.rows.length*this.rows[0].length,r=0;if(e.runForEachCell((function(e,t,n){n&&r++}),this.rows),t===r)return this.highScores.push([this.score,this.moveCount,e.getMax(this.rows)]),this.restart(),!0}},{key:"handleInput",value:function(t){if(e.isValidKey(t)){this.moveCount++;var r=e.getNextState(this.rows,t,this.moveCount),n=Object(A["a"])(r,2),o=n[0],i=n[1];this.score+=i,this.rows=o,this.updateCells();var a=this.checkLose();a||(M(o,L),this.rows=o,this.updateCells())}}}],[{key:"getNextState",value:function(t,r,n){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=0,a=x()(t),c=0;c<a.length;c++)for(var u=a[c],l=0;l<u.length;l++)if(!o["".concat(c,"-").concat(l)]){var s=u[l];if(s){var h=s.number,f=e.getMoveDestination(a,c,l,h,r,o);if(f){var v=Object(A["a"])(f,2),d=v[0],b=v[1];if(d===c&&b===l)continue;var g=u[l];a[d][b]?(a[d][b].is(h)||console.error("cell ".concat(s," from ").concat(c,",").concat(l," moved to ").concat(d,",").concat(b," with ").concat(a[d][b])),o["".concat(d,"-").concat(b)]=!0,g.add(a[d][b].number,g),i+=g.number,g.updatePos(d,b),a[d][b]=g,u[l]=void 0):(g.updatePos(d,b),a[d][b]=g,u[l]=void 0)}}}return e.squeeze(a,r),e.addRandomNumbers(1,a,n),[a,i]}},{key:"runForEachCell",value:function(e,t){for(var r=0;r<t.length;r++)for(var n=t[r],o=0;o<n.length;o++){var i=n[o];e(r,o,i)}}},{key:"isValidKey",value:function(e){return e===z.ArrowUp||e===z.ArrowDown||e===z.ArrowLeft||e===z.ArrowRight}},{key:"addNumberToPosition",value:function(e,t,r,n,o){var i=new P(t,r,e,n);o[t][r]=i}},{key:"getRandomPosition",value:function(){var e=Math.random();return e<.25?0:e<.5?1:e<.75?2:3}},{key:"getRandomNumber",value:function(){return 2}},{key:"getFilledCount",value:function(t){var r=0;return e.runForEachCell((function(e,t,n){n&&r++}),t),r}},{key:"getEmptyCount",value:function(t){return e.rowCount*e.colCount-e.getFilledCount(t)}},{key:"squeeze",value:function(t,r){for(var n=!1,o=0;o<t.length;o++)for(var i=t[o],a=0;a<i.length;a++){var c=i[a];if(c){var u=e.getSqueezeDestination(t,o,a,r);if(u){var l=Object(A["a"])(u,2),s=l[0],h=l[1];if(s===o&&h===a)continue;n=!0;var f=i[a];t[s][h]?(console.error("something wrong r c",s,h),console.error("rows[r][c]",t[s][h])):(f.updatePos(s,h),t[s][h]=f,i[a]=void 0)}}}n&&e.squeeze(t,r)}},{key:"getSqueezeDestination",value:function(e,t,r,n){switch(n){case z.ArrowUp:if(0===t)return[t,r];for(var o=t-1;o>=0;o--)if(e[o][r])return[o+1,r];return[0,r];case z.ArrowDown:if(t===e.length-1)return[t,r];for(var i=t+1;i<=e.length-1;i++)if(e[i][r])return[i-1,r];return[e.length-1,r];case z.ArrowLeft:if(0===r)return[t,r];for(var a=r-1;a>=0;a--)if(e[t][a])return[t,a+1];return[t,0];case z.ArrowRight:if(r===e[0].length-1)return[t,r];for(var c=r+1;c<=e[0].length-1;c++)if(e[t][c])return[t,c-1];return[t,e[0].length-1];default:break}}},{key:"getMax",value:function(t){var r=0;return e.runForEachCell((function(e,t,n){n&&n.number>r&&(r=n.number)}),t),r}},{key:"getRandomEmptyCell",value:function(t){var r=[];if(e.runForEachCell((function(e,t,n){n||r.push([e,t])}),t),0===r.length)return[0,0];var n=Math.floor(Math.random()*r.length);return r[n]}},{key:"addRandomNumbers",value:function(t,r,n){for(var o=0;o<t;o++){var i=e.getRandomEmptyCell(r),a=Object(A["a"])(i,2),c=a[0],u=a[1];if(r[c][u])return;var l=e.getRandomNumber();e.addNumberToPosition(l,c,u,n,r)}}}]),e}();Object(p["a"])(I,"winNumber",D),Object(p["a"])(I,"rowCount",4),Object(p["a"])(I,"colCount",4),Object(p["a"])(I,"getMoveDestination",(function(e,t,r,n,o,i){switch(o){case z.ArrowUp:if(0===t)return[t,r];for(var a=t-1;a>=0;a--)if(i["".concat(a,"-").concat(r)]){if(e[a][r])return[a+1,r]}else if(e[a][r])return e[a][r].is(n)?[a,r]:[a+1,r];return[t,r];case z.ArrowDown:if(t===e.length-1)return[t,r];for(var c=t+1;c<=e.length-1;c++)if(i["".concat(c,"-").concat(r)]){if(e[c][r])return[c-1,r]}else if(e[c][r])return e[c][r].is(n)?[c,r]:[c-1,r];return[t,r];case z.ArrowLeft:if(0===r)return[t,r];for(var u=r-1;u>=0;u--)if(i["".concat(t,"-").concat(u)]){if(e[t][u])return[t,u+1]}else if(e[t][u])return e[t][u].is(n)?[t,u]:[t,u+1];return[t,r];case z.ArrowRight:if(r===e[0].length-1)return[t,r];for(var l=r+1;l<=e[0].length-1;l++)if(i["".concat(t,"-").concat(l)]){if(e[t][l])return[t,l-1]}else if(e[t][l])return e[t][l].is(n)?[t,l]:[t,l-1];return[t,r];default:break}}));var U={name:"GameBoard",data:function(){var e=80,t=10;return{cellSize:e,marginSize:t}},computed:{totalSize:function(){return 4*this.cellSize+3*this.marginSize}},props:{game:I,cells:Array,rows:Array,animation:Boolean}};r("2b94");U.render=y;var T=U,_=(r("a630"),r("a15b"),r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),r("2909")),q=!1;function B(){var e=Math.random();return e<.25?z.ArrowDown:e<.5?z.ArrowUp:e<.75?z.ArrowLeft:z.ArrowRight}var G=3,J=10;function K(e,t){q&&console.log("---"),M(e,q);for(var r=0,n=null,o=new Set,i=[[z.ArrowDown],[z.ArrowUp],[z.ArrowLeft],[z.ArrowRight]],a=1;a<G;a++){for(var c=[],u=0;u<i.length;u++)for(var l=i[u],s=0;s<E.length;s++){var h=E[s];c.push([].concat(Object(_["a"])(l),[h]))}i=c}for(var f=0;f<i.length;f++){for(var v=i[f],d=0,b=0,g=0,m=[],w=[],p=0;p<J;p++){var j=x()(e);m[p]=0;for(var O=0;O<v.length;O++){var y=v[O],k=0,S=I.getNextState(j,y,t),C=Object(A["a"])(S,2);j=C[0],k=C[1],m[p]+=k,0===O&&(g=k)}w[p]=I.getEmptyCount(j)}d=R(m),b=R(w),q&&console.log(v.join(" "),m.join(" "),d,g),d+=10*b,d>r?(o=new Set,o.add(v[0]),r=d):d===r&&o.add(v[0])}var N=Array.from(o);q&&console.log("getAutoMoveScoreNStepsMC -> candidatesArr",N);var P=Math.floor(Math.random()*N.length);return n=N[P],n||console.error("no selected"),n}console.log("".concat(G," moves heads ").concat(J," rounds MC"));var V=0,X=!0,Y={name:"App",components:{GameBoard:T},mounted:function(){var e=this;this.game.restart(),this.cells=this.game.cells,window.onkeyup=function(t){e.cells=e.handleEvent(t.code)},document.addEventListener("touchstart",o,!1),document.addEventListener("touchmove",i,!1);var t=null,r=null;function n(e){return e.touches||e.originalEvent.touches}function o(e){var o=n(e)[0];t=o.clientX,r=o.clientY}function i(e){if(t&&r){var n=e.touches[0].clientX,o=e.touches[0].clientY,i=t-n,a=r-o;Math.abs(i)>Math.abs(a)?this.cells=i>0?this.handleEvent(z.ArrowLeft):this.handleEvent(z.ArrowRight):this.cells=a>0?this.handleEvent(z.ArrowUp):this.handleEvent(z.ArrowDown),t=null,r=null}}},data:function(){var e=new I;return{game:e,cells:e.cells,isAuto:!1,autoInterval:null,animation:X}},methods:{restart:function(){this.game.restart(),this.cells=this.game.cells},handleAuto:function(){var e=this;this.isAuto=!this.isAuto,this.autoInterval&&clearInterval(this.autoInterval),this.isAuto?(this.animation=!1,this.autoSolve(),this.autoInterval=setInterval((function(){e.autoSolve()}),V)):this.animation=!0},handleSolve:function(){this.autoSolve()},autoSolve:function(){var e,t=!1;e=t?B():K(this.game.rows,this.game.moveCount),this.cells=this.handleEvent(e)},handleEvent:function(e){return this.game.handleInput(e),this.game.cells}}};r("e9d9");Y.render=w;var H=Y,W=Object(n["b"])({render:function(){return Object(n["g"])(H)}});W.mount("#app")},c539:function(e,t,r){},e9d9:function(e,t,r){"use strict";r("c539")},f046:function(e,t,r){}});
//# sourceMappingURL=app.694c508a.js.map